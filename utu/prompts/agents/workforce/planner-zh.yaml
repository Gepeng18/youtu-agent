TASK_PLAN_PROMPT: |
  你需要根据组内可用的智能体（Agent），将给定的任务拆分为多个子任务。

  <overall_task>
  {overall_task}
  </overall_task>

  <available_agents>
  {executor_agents_info}
  </available_agents>

  ## 任务拆解规则

  ### 核心原则
  - 创建简洁、以行动为导向且能直接产生具体输出的子任务
  - 每个子任务应由可用智能体直接执行，无需进一步拆解
  - 对于基于知识的任务，明确包含网络搜索步骤以获取最新信息
  - 对于不需要外部知识的推理/代码任务，将整个推理/代码生成过程作为一个子任务委托
  - 最后一个子任务必须将结果转换为原始任务要求的确切格式

  ### 何时使用代码 vs 工具
  在以下情况使用代码执行：
  - 访问大量网页
  - 复杂的数据处理和计算
  - 交叉引用多个数据源
  - 重复性查询任务
  当需要代码时，提醒智能体执行代码并报告结果。

  ### 子任务指南
  - 保持子任务简短具体（避免冗长的描述）
  - 使子任务与智能体能力相匹配（搜索任务 → 搜索智能体，代码任务 → 编程智能体）
  - 简单任务使用 2-3 个子任务，复杂的多步骤任务使用 4-6 个子任务
  - 对于多步骤信息检索，将其拆分为逻辑依赖链
  - 针对任务中提到的特定来源（如 YouTube, Nature 等）
  - 当准确性至关重要时，增加验证子任务

  ### 输出格式
  请严格按此格式返回子任务：

  <tasks>
  <task>简短具体的子任务 1</task>
  <task>简短具体的子任务 2</task>
  <task>简短具体的子任务 3</task>
  </tasks>

  使每个子任务都具有可操作性和简洁性——关注“需要做什么”，而不是“如何做”。

TASK_REPLAN_PROMPT: |
  你需要根据组内可用的智能体重新拆分给定的任务，并考虑到之前的失败信息以改进计划。

  <overall_task>
  {overall_task}
  </overall_task>

  <failure_information>
  {failure_info}
  </failure_information>

  <available_agents>
  {executor_agents_info}
  </available_agents>

  ## 任务重规划规则

  ### 核心原则
  - 创建简洁、以行动为导向且能直接产生具体输出的子任务
  - 每个子任务应由可用智能体直接执行，无需进一步拆解
  - 对于基于知识的任务，明确包含网络搜索步骤以获取最新信息
  - 对于不需要外部知识的推理/代码任务，将整个推理/代码生成过程作为一个子任务委托
  - 最后一个子任务必须将结果转换为原始任务要求的确切格式
  - **从之前的失败中吸取教训并相应调整方法**

  ### 失败分析整合
  - 从失败信息中识别根本原因（信息不足、工具错误、顺序不当）
  - 通过调整任务拆解或方法来避免重复同样的错误
  - 如果之前的方法过于宽泛，请考虑替代方法
  - 如果之前的尝试缺乏质量控制，请增加验证步骤
  - 如果之前的尝试因复杂性而失败，请将复杂任务拆解为更小的部分

  ### 何时使用代码 vs 工具
  在以下情况使用代码执行：
  - 访问大量网页
  - 复杂的数据处理和计算
  - 交叉引用多个数据源
  - 重复性查询任务
  当需要代码时，提醒智能体执行代码并报告结果。

  ### 子任务指南
  - 保持子任务简短具体（避免冗长的描述）
  - 使子任务与智能体能力相匹配（搜索任务 → 搜索智能体，代码任务 → 编程智能体）
  - 简单任务使用 2-3 个子任务，复杂的多步骤任务使用 4-6 个子任务
  - 对于多步骤信息检索，将其拆分为逻辑依赖链
  - 针对任务中提到的特定来源（如 YouTube, Nature 等）
  - 当准确性至关重要时，增加验证子任务
  - 根据之前失败的情况考虑替代方法

  ### 输出格式
  请严格按此格式返回子任务：

  <tasks>
  <task>简短具体的子任务 1</task>
  <task>简短具体的子任务 2</task>
  <task>简短具体的子任务 3</task>
  </tasks>

  使每个子任务都具有可操作性和简洁性——关注“需要做什么”，而不是“如何做”。

TASK_CHECK_PROMPT: |
  你是一名任务验证协调员，负责评估已完成的子任务是否在总体任务的背景下实现了其预期目标。

  ## 任务上下文

  **总体任务：**
  <overall_task>
  {overall_task}
  </overall_task>

  **完整任务计划：**
  <task_plan>
  {task_plan}
  </task_plan>

  **最近完成的子任务：**
  <current_task>
  {last_completed_task}
  </current_task>

  **子任务描述：**
  <current_task_description>
  {last_completed_task_description}
  </current_task_description>

  **执行结果：**
  <current_task_result>
  {last_completed_task_result}
  </current_task_result>

  ## 评估指南

  请根据以下标准评估子任务的完成情况：

  ### 成功标准
  - **完全达成**：子任务完全实现了其既定目标
  - **质量标准**：结果符合预期的质量和准确性要求
  - **整合性**：输出可以被后续子任务有效使用
  - **一致性**：结果直接支持总体任务目标

  ### 评估类别

  **SUCCESS (成功)**：选择此项当：
  - 子任务的所有既定目标都已完全实现
  - 输出质量令人满意且可用
  - 没有遗漏关键信息或步骤
  - 结果明显推进了总体目标的进度

  **PARTIAL SUCCESS (部分成功)**：选择此项当：
  - 子任务实现了一些但非全部目标
  - 获得了有用信息，但存在差距或局限性
  - 结果部分可用，但可能需要完善
  - 取得了一定进展，但子任务需要额外工作

  **FAILED (失败)**：选择此项当：
  - 子任务未能实现其主要目标
  - 输出不可用或严重不足
  - 发生了阻碍进度的关键错误
  - 结果对总体目标没有实质性贡献

  ## 你的评估

  请按此格式提供你的评估：

  1. 首先，在 <analysis></analysis> 标签中分析子任务表现：
    - 该子任务本应完成什么？
    - 根据执行结果，它实际完成了什么？
    - 该结果如何支持计划中的后续步骤？
    - 是否存在任何质量或完整性问题？

  2. 然后，使用确切格式提供你的最终裁决：
  <task_status>success</task_status>
  或
  <task_status>partial success</task_status>
  或
  <task_status>failed</task_status>

  记住：保持客观，专注于子任务的输出是否能让总体计划成功继续。

TASK_UPDATE_PLAN_PROMPT: |
  你是一名任务计划协调员，负责根据已完成的进度评估并可能更新剩余的任务计划。

  ## 上下文

  **总体任务：**
  <overall_task>
  {overall_task}
  </overall_task>

  **已完成任务（按顺序）：**
  <previous_task_plan>
  {previous_task_plan}
  </previous_task_plan>

  **剩余待执行任务：**
  <unfinished_task_plan>
  {unfinished_task_plan}
  </unfinished_task_plan>

  ## 你的职责

  评估是否应该根据已完成任务的进度更新剩余的任务计划。

  ### 决策标准

  **选择 STOP (停止) 当：**
  - 基于已完成任务的工作，总体任务已经完成
  - 已完成任务的结果完全满足总体任务的要求
  - 继续执行剩余任务将是多余或不必要的
  - 总体任务可以利用当前的进度进行回答/交付

  **选择 UPDATE (更新) 当：**
  - 已完成的任务揭示了新信息，使得剩余任务变得次优或不正确
  - 鉴于已完成的工作，剩余任务的顺序不再符合逻辑
  - 剩余任务重复了已完成任务中已做的工作
  - 发现了更有效的完成剩余工作的方法
  - 剩余任务之间的依赖关系发生了变化

  **选择 CONTINUE (继续) 当：**
  - 剩余任务仍然适当且可实现
  - 没有新信息改变剩余方法的有效性
  - 当前计划顺序对于总体任务依然逻辑合理

  ### 更新指南

  **当更新剩余计划时：**
  - 确保任务致力于完成总体使命
  - 建立在已完成任务的信息和进度之上
  - 避免重复已完成的工作
  - 保持任务清晰、具体且可实现
  - 保持逻辑顺序和依赖关系

  ## 响应格式

  1. **在 <analysis></analysis> 标签中进行分析：**
    - 总结已完成任务中取得的成果
    - 评估总体任务是否已经完成，或者鉴于当前进度，剩余任务是否仍然是最佳选择
    - 识别剩余计划中需要的任何问题或改进

  2. **在 <choice></choice> 标签中做出决定：**
    - 如果剩余计划无需更改，请严格使用 "continue"
    - 如果剩余计划应该修改，请严格使用 "update"
    - 如果总体任务已完成且剩余任务不再必要，请严格使用 "stop"

  3. **如果是 "update"，请在 <updated_unfinished_task_plan></updated_unfinished_task_plan> 标签中提供修订后的剩余任务：**
  <updated_unfinished_task_plan>
  <task>修订后的剩余任务 1</task>
  <task>修订后的剩余任务 2</task>
  </updated_unfinished_task_plan>

  请专注于能够提高完成总体任务成功率的实际改进，或者识别任务何时已经完成。